---
const { classes } = Astro.props;
const currentPath = Astro.url.pathname;
const isHomepage = currentPath === "/" || currentPath === "/en" || currentPath === "/en/" || currentPath === "/cy" || currentPath === "/cy/";
const currentPathMinusLanguage = currentPath.split("/").slice(2).join("/");
---

<script>
  function languageSwitcher() {
    // use URL to read current language
    const url = new URL(window.location.href);
    const segments = url.pathname
      .replace(/^\/+/, "")
      .split("/")
      .filter(Boolean);
    const currentLanguage = segments[0] === "cy" ? "cy" : "en";

    // Remove active class from all language options
    const allLangDivs = document.querySelectorAll("#language-switcher > div");
    allLangDivs.forEach((div) => div.classList.remove("active"));

    // Add active class to current language
    const activeDiv = document.querySelector(
      `#language-switcher #${currentLanguage}`
    );
    if (activeDiv) {
      activeDiv.classList.add("active");
    }
  }
  document.addEventListener("DOMContentLoaded", () => languageSwitcher());
</script>

<div id="language-switcher" class="flex overflow-hidden justify-between border-primary border rounded xl:border-none">
  <div id="cy" class="join-item">
    <a class="lang-cymru" href={`/cy/${currentPathMinusLanguage}`}>
      <p class="mr-1 xl:mr-0">Cymraeg</p>
      <svg
        width="17"
        height="17"
        viewBox="0 0 17 17"
        xmlns="http://www.w3.org/2000/svg"
      >
        <circle cx="8.5" cy="8.5" r="8.5" fill="currentColor"></circle>
      </svg>
    </a>
  </div>
  <div id="en" class="join-item">
    <a class="lang-english" href={isHomepage ? "/" : `/en/${currentPathMinusLanguage}`}>
      <p class="mr-1 xl:mr-0">English</p>
      <svg
        width="17"
        height="17"
        viewBox="0 0 17 17"
        xmlns="http://www.w3.org/2000/svg"
      >
        <circle cx="8.5" cy="8.5" r="8.5" fill="currentColor"></circle>
      </svg>
    </a>
  </div>
</div>
